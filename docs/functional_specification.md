# 구성 기능
## 사용자
### 상품 조회

- 상품 목록 검색
    - 검색은 상품명 기준으로 적용
        - 검색은 기본적으로 상품명 포함 검색 (Like)
        - 기본적으로 노출은 판매 가능한 상품만 노출
            - 재고 1개 이상
            - 판매 가능 여부 Y
    - 상세 조회
        - 상품 정보
        - 장바구니 담기
            - 반드시 회원 로그인 필요
            - 구매 불가 상태로 표시
                - 재고 1개 이상
                - 판매 가능 여부 Y

### 주문/결제

- 주문 처리
    - 주문 생성 (장바구니에서 결제 클릭 시)
        - 주문 검증
            - 상품
                - 재고 1개 이상
                - 판매 가능 여부 Y
            - 가격
                - 현재 판매가·옵션가가 장바구니에 담겼던 시점과 달라지지 않았는지
        - 주문 상태 : **`CREATED` : 주문** 정보 화면 (장바구니에서 결제 주문 클릭 후 생성)
        - 결제 상태 : **`PENDING`** : 결제 시도 중 (주문 정보 화면에서 결제하기 클릭)
- 결제 처리
    - 결제 승인 검증 (PG 창에서 사용자 인증을 마친 후라고 가정)
        - 상품
            - 재고 1개 이상
            - 판매 가능 여부 Y
        - 생성된 주문의 금액과 클라이언트·결제창에서 돌아온 금액/주문번호가 완전히 같은지 비교
        - 검증 성공 시 승인 API 호출 : MOCK
    - 승인 API의 최종 여부에 따라 결과 분기
        - 결제 성공
            - 재고 차감
            - 주문 상태 : **`COMPLETED`** : 결제까지 성공해서 최종 확정
            - 결제 상태 : **`PAID`** : 결제 승인 성공
        - 실패 처리
            - 주문 상태 : **`CREATED` : 변동 없음**
            - 결제 상태 : **`FAILED`**: 결제 실패

### 회원

- 회원가입
    - 입력값
        - 이메일
            - 중복 가입 방지
                - 중복의 기준
                    - 이메일 존재 여부 체크
        - 비밀번호
            - 비밀번호 검증
                - 최소/최대 길이 (예: 8~20자)
- 로그인/ 로그아웃
    - 공통 정책
        - 인증/ 인가 정책
    - 토큰 관련 정책
        - Access Token
            - API 접근
            - 수명 : 5 - 30분
        - Refresh Token
            - Access 재발급
            - 7 - 30일
- 로그아웃
    - Redis에서 삭제
- 재로그인
    - 기존 토큰 무효화
- 프로필 수정
    - 회원정보
        - 이메일 수정 불가
        - 비밀번호 변경
            - 회원 가입 시의 비밀번호 검증과 동일한 검증
- 내 주문 내역
    - 목록 조회
        - 주문 완료 이후 관리자 등에서 상품에 대한 정보가 변경될 수 있으나, 이 목록 조회에서는 구매 당시의 상품 정보가 필요하기에 따로 주문과 관련된 상품 정보 저장 필요
    - 주문 상세 조회
- 내 장바구니
    - 목록 조회
    - 구매 불가 상태로 표시
        - 재고 1개 이상
        - 판매 가능 여부 Y
    - 상품 상세 조회