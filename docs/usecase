# 회원가입

## 정상 흐름
1. 회원이 이메일/비밀번호 입력 후 서버로 회원가입 요청을 전송한다.   
2. 서버는 이메일 중복 검증을 통과한다.   
3. 서버는 비밀번호 정책 검증을 통과한다.   
4. 서버는 회원 가입을 완료하고 성공 코드와 메시지를 반환한다.   
5. 회원은 화면에서 성공 메시지를 확인한다.   

## 실패 흐름
### 이메일이 이미 존재하는 경우
1. 서버는 이메일 중복 검증에서 실패하고, “이미 사용 중인 이메일”에 대한 에러 코드·메시지를 반환한다.

### 비밀번호 정책에 맞지 않는 경우
1. 서버는 비밀번호 검증에서 실패하고, “비밀번호 정책 위반”에 대한 에러 코드·메시지를 반환한다.   
2. 회원은 화면에서 실패 메시지를 확인하고, 값을 수정하여 다시 시도한다.   

# 로그인
## 정상 흐름
1. 회원이 이메일/비밀번호를 입력하고 로그인 요청을 전송한다.   
2. 서버는 해당 이메일의 회원을 찾는다.   
3. 서버는 저장된 비밀번호와 입력한 비밀번호가 일치함을 검증한다.   
4. 서버는 로그인 성공 응답을 반환하고, 토큰을 발급한다.   
5. 회원은 성공 메시지 혹은 메인 화면으로의 이동을 확인한다.   

## 실패 흐름
### 이메일이 존재하지 않는 경우
1. 서버는 회원 조회 단계에서 실패하고, “존재하지 않는 이메일” 에러 코드·메시지를 반환한다.   
### 이메일은 존재하지만 비밀번호가 일치하지 않는 경우
1. 서버는 비밀번호 검증에서 실패하고, “비밀번호 불일치” 에러 코드·메시지를 반환한다.   
2. 회원은 화면에서 실패 메시지를 확인하고 다시 입력한다.   

# 상품 검색
## 정상 흐름
1. 회원이 검색창에 상품명을 입력하여 검색 요청을 보낸다.   
2. 서버는 조건에 맞는 상품 목록을 조회하고 목록을 반환한다.   
3. 회원은 목록 중 특정 상품을 클릭하여 상세 화면으로 진입한다.   
4. 서버는 해당 상품의 상세 정보를 조회하여 반환한다.   
5. 회원은 화면에서 상품 상세 정보를 확인한다.   

## 실패 흐름
### 검색 조건에 해당하는 상품이 없는 경우
1. 서버는 빈 목록을 반환한다.

# 장바구니 추가
## 정상 흐름
1. 회원이 상품 상세 화면에서 “장바구니에 추가” 버튼을 클릭한다.   
2. 서버는 로그인 여부를 검증하고, 상품 판매 가능 여부/재고 등을 검증한다.   
3. 모든 검증을 통과하면 해당 상품(들)을 해당 회원의 장바구니 데이터에 저장한다.   
4. 서버는 장바구니 추가 성공 코드와 메시지를 반환한다.   
5. 회원은 화면에서 성공 메시지를 확인한다.   

## 실패 흐름
### 로그인하지 않은 상태
1. 서버는 로그인 정보를 찾지 못하고, 인증 관련 에러 코드·메시지를 반환한다.
   
### 상품이 판매 중지 상태이거나 재고가 없는 경우   
1. 서버는 판매 가능 여부/재고 검증 단계에서 실패하고, 그에 맞는 에러 코드·메시지를 반환한다.   

# 주문 생성(장바구니 → 주문)
## 정상 흐름
1. 회원이 장바구니에서 “주문하기” 버튼을 클릭하여 주문 정보 화면으로 진입한다.   
2. 서버는 주문 생성 전에 상품 판매 가능 여부와 재고 정보를 다시 조회하여 검증한다.   
3. 검증을 통과하면 서버는 주문을 생성하고, 주문 상태를 CREATED로 설정한다.   
4. 회원은 주문 정보 화면에서 생성된 주문 내용을 확인한다.   

## 실패 흐름
### 로그인 정보가 없거나 세션이 만료된 경우
1. 서버는 인증 검증에서 실패하고 에러 코드·메시지를 반환한다.   

### 장바구니에 담긴 상품 중 일부가 더 이상 판매 불가 또는 재고 부족인 경우   
1. 서버는 검증 단계에서 실패하고 “주문 불가(재고/판매 상태)” 에러 코드·메시지를 반환한다.   
2. 회원은 실패 메시지를 보고 장바구니를 수정하거나, 재시도한다.

# 결제
## 정상 흐름
1. 회원이 주문 정보 화면에서 내용을 확인한 뒤 “결제하기” 버튼을 클릭한다.   
2. 서버는 주문이 생성(CREATED) 상태인지, 포함된 상품의 판매 상태와 재고가 정상인지 재검증한다.   
3. 검증에 성공하면 서버는 결제 정보 입력 화면 URL을 반환하고, 결제 상태를 PENDING으로 설정한다.   
4. 회원은 PG 결제 화면으로 이동해 결제 정보를 입력하고 “결제 승인”을 진행한다.   
5. 화면(클라이언트)은 입력된 결제 정보와 함께 서버로 “결제 승인 API”를 호출한다.   
6. 서버는 PG에 결제 승인 요청을 보내기 전에, 요청된 결제 정보와 주문 정보의 일치 여부를 검증한다.   
7. PG사는 결제 승인 API 응답으로 성공을 반환한다.   
8. 재고를 차감하고, 주문 상태를 COMPLETED로 변경하고, 결제 상태를 PAID로 설정한다.   
9. 회원은 결제 성공 화면/메시지를 확인한다.

## 실패 흐름
### 주문이 존재하지 않거나 CREATED 상태가 아닌 경우
서버는 초기 검증 단계에서 실패하고, 주문 상태 이상에 대한 에러 코드·메시지를 반환한다.

### 주문의 상품 중 일부가 더 이상 판매 불가 혹은 재고 부족인 경우
서버는 검증 단계에서 실패하고, “결제 진행 불가(재고/판매 상태)” 에러를 반환한다.

### 결제 정보와 주문 정보가 일치하지 않는 경우 (금액, 주문 ID 등)
서버는 자체 검증에서 실패하고, 데이터 불일치 에러를 반환한다.

### PG 응답이 실패인 경우(승인 거절, 한도 초과, 네트워크 오류 등)
1. 서버는 결제 실패로 판단하고 주문 상태를 CREATED로 유지, 결제 상태를 FAILED로 설정한다.   
2. 클라이언트에는 결제 실패 코드·메시지를 반환한다.   
3. 회원은 실패 메시지를 확인하고, 결제를 재시도하거나 주문을 수정한다.

# 프로필 수정
## 정상 흐름
1. 회원이 마이페이지로 진입한 뒤 “프로필 수정”을 클릭한다.   
2. 서버는 로그인 정보를 검증하고, 회원 상세 정보를 반환한다.   
3. 회원은 화면에서 기존 정보를 확인하고, 수정할 정보를 입력해 서버로 요청한다.   
4. 서버는 수정된 회원 정보의 유효성(형식, 정책 등)을 검증한다.   
5. 검증에 성공하면 서버는 회원 정보를 업데이트하고 성공 메시지를 반환한다.   
6. 회원은 화면에서 수정 결과(성공 메시지 혹은 변경된 정보)를 확인한다.

## 실패 흐름
### 로그인 정보가 없거나 세션이 만료된 경우
1. 서버는 인증 검증에서 실패하고 에러 코드·메시지를 반환한다.   
2. 수정 요청한 정보가 정책에 맞지 않는 경우 (예: 비밀번호 길이 등)   
3. 서버는 유효성 검증에서 실패하고 해당 사유의 에러 코드·메시지를 반환한다.   
4. 회원은 실패 메시지를 확인하고 값을 수정해 재요청한다.   

# 내 주문 내역 조회
## 정상 흐름
1. 회원이 마이페이지에 진입한다.   
2. 회원이 “내 주문 내역 조회”를 클릭한다.   
3. 서버는 로그인 정보를 검증하고, 해당 회원의 주문 내역 목록을 조회해 반환한다.   
4. 회원은 주문 내역 리스트를 화면에서 확인한다.   

## 실패 흐름
### 로그인 정보가 없거나 세션이 만료된 경우
서버는 인증 검증에서 실패하고 에러 코드·메시지를 반환한다.

### 주문 내역이 하나도 없는 경우
서버는 빈 목록을 반환한다.

# 내 장바구니 목록 조회
## 정상 흐름
1. 회원이 마이페이지에 진입한다.   
2. 회원이 “내 장바구니 목록 조회”를 클릭한다.   
3. 서버는 로그인 정보를 검증하고, 해당 회원의 장바구니 목록을 조회하여 반환한다.   
4. 회원은 장바구니 목록을 화면에서 확인한다.

## 실패 흐름
### 로그인 정보가 없거나 세션이 만료된 경우
서버는 인증 검증에서 실패하고 에러 코드·메시지를 반환한다.  

### 장바구니에 담긴 상품이 없는 경우
서버는 빈 목록을 반환한다.